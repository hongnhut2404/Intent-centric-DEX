sequenceDiagram
    participant Alice
    participant Bob
    participant OffChainTx

    Alice->>Bob: Propose new balances (AliceBalance, BobBalance)
    Bob->>Alice: Reviews balances, agrees

    Alice->>OffChainTx: Builds unsigned commitment transaction
    Bob->>OffChainTx: Confirms unsigned transaction

    Alice->>Alice: Signs transaction with Alice's key
    Alice->>Bob: Sends Alice’s partial signature
    Bob->>Bob: Verifies Alice's signature
    Bob->>Bob: Signs transaction with Bob's key
    Bob->>Alice: Sends Bob’s signature

    OffChainTx->>OffChainTx: Combines both signatures
    OffChainTx->>Alice: Returns fully signed transaction
    OffChainTx->>Bob: Returns fully signed transaction

    note over OffChainTx: Fully signed commitment<br>is ready for broadcast<br>if needed
